{"ast":null,"code":"import React,{useState,useEffect}from'react';import{socketService}from'../services/SocketService';import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";const Editor=_ref=>{let{roomId}=_ref;const[lines,setLines]=useState(['']);const[isConnected,setIsConnected]=useState(false);useEffect(()=>{// Connect to socket server\nconst socket=socketService.connect();socket.on('connect',()=>{setIsConnected(true);socketService.joinRoom(roomId);});socket.on('disconnect',()=>{setIsConnected(false);});socket.on('document:initial-load',data=>{setLines(data.content);});socket.on('document:line-updated',data=>{setLines(prevLines=>{const newLines=[...prevLines];newLines[data.lineNumber]=data.content;return newLines;});});return()=>{socketService.disconnect();};},[roomId]);const handleLineChange=(lineNumber,content)=>{// Update local state immediately\nsetLines(prevLines=>{const newLines=[...prevLines];newLines[lineNumber]=content;return newLines;});// Send to server\nsocketService.editLine(roomId,lineNumber,content);};const addLine=()=>{setLines(prevLines=>[...prevLines,'']);};const userInfo=socketService.getUserInfo();return/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'20px'},children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Room: \",roomId]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"User: \",userInfo.username]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Status: \",isConnected?'ðŸŸ¢ Connected':'ðŸ”´ Disconnected']})]}),/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:'10px'},children:/*#__PURE__*/_jsx(\"button\",{onClick:addLine,children:\"Add Line\"})}),/*#__PURE__*/_jsx(\"div\",{style:{border:'1px solid #ccc',padding:'10px'},children:lines.map((line,index)=>/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'5px'},children:[/*#__PURE__*/_jsxs(\"span\",{style:{marginRight:'10px',color:'#666'},children:[index,\":\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:line,onChange:e=>handleLineChange(index,e.target.value),style:{width:'400px',fontFamily:'monospace'},placeholder:\"Type code here...\"})]},index))})]});};export default Editor;","map":{"version":3,"names":["React","useState","useEffect","socketService","jsxs","_jsxs","jsx","_jsx","Editor","_ref","roomId","lines","setLines","isConnected","setIsConnected","socket","connect","on","joinRoom","data","content","prevLines","newLines","lineNumber","disconnect","handleLineChange","editLine","addLine","userInfo","getUserInfo","style","padding","children","marginBottom","username","onClick","border","map","line","index","marginRight","color","type","value","onChange","e","target","width","fontFamily","placeholder"],"sources":["/Users/xuy4/collaborative-editor/packages/client/src/components/Editor.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { socketService } from '../services/SocketService';\n\ninterface EditorProps {\n  roomId: string;\n}\n\nconst Editor: React.FC<EditorProps> = ({ roomId }) => {\n  const [lines, setLines] = useState<string[]>(['']);\n  const [isConnected, setIsConnected] = useState(false);\n\n  useEffect(() => {\n    // Connect to socket server\n    const socket = socketService.connect();\n    \n    socket.on('connect', () => {\n      setIsConnected(true);\n      socketService.joinRoom(roomId);\n    });\n\n    socket.on('disconnect', () => {\n      setIsConnected(false);\n    });\n\n    socket.on('document:initial-load', (data) => {\n      setLines(data.content);\n    });\n\n    socket.on('document:line-updated', (data) => {\n      setLines(prevLines => {\n        const newLines = [...prevLines];\n        newLines[data.lineNumber] = data.content;\n        return newLines;\n      });\n    });\n\n    return () => {\n      socketService.disconnect();\n    };\n  }, [roomId]);\n\n  const handleLineChange = (lineNumber: number, content: string) => {\n    // Update local state immediately\n    setLines(prevLines => {\n      const newLines = [...prevLines];\n      newLines[lineNumber] = content;\n      return newLines;\n    });\n\n    // Send to server\n    socketService.editLine(roomId, lineNumber, content);\n  };\n\n  const addLine = () => {\n    setLines(prevLines => [...prevLines, '']);\n  };\n\n  const userInfo = socketService.getUserInfo();\n\n  return (\n    <div style={{ padding: '20px' }}>\n      <div style={{ marginBottom: '20px' }}>\n        <h2>Room: {roomId}</h2>\n        <p>User: {userInfo.username}</p>\n        <p>Status: {isConnected ? 'ðŸŸ¢ Connected' : 'ðŸ”´ Disconnected'}</p>\n      </div>\n\n      <div style={{ marginBottom: '10px' }}>\n        <button onClick={addLine}>Add Line</button>\n      </div>\n\n      <div style={{ border: '1px solid #ccc', padding: '10px' }}>\n        {lines.map((line, index) => (\n          <div key={index} style={{ marginBottom: '5px' }}>\n            <span style={{ marginRight: '10px', color: '#666' }}>{index}:</span>\n            <input\n              type=\"text\"\n              value={line}\n              onChange={(e) => handleLineChange(index, e.target.value)}\n              style={{ width: '400px', fontFamily: 'monospace' }}\n              placeholder=\"Type code here...\"\n            />\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n};\n\nexport default Editor;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}